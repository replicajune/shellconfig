name: Shellcheck

on: [push]

jobs:
  build:

    runs-on: ubuntu-latest

    steps:
      - name: clone
        uses: actions/checkout@v1
      - name: install
        run: |
          sudo apt-get -qqq update &> /dev/null
          sudo apt-get -qqq -y install --no-install-recommends shellcheck
      - name: lint
        run: |
          while IFS= read -r -d '' SHELL_FILE; do
                shellcheck --external-sources --format=gcc --color=always \
                  --exclude=SC1090 "${SHELL_FILE}" || ERROR=1
          done  < <(find . -name "*.sh" -type f -print0)
          [ -n "${ERROR}" ] && echo 1
